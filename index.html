<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Les Odyss√©es ‚Äì Louis XIV √† Versailles</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --gold: #c9a84c;
    --gold-light: #f0d080;
    --dark: #1a1008;
    --dark2: #2a1e0a;
    --cream: #fdf6e3;
    --red: #8b1a1a;
    --green: #1a5c2a;
    --blue: #1a3a6b;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    min-height: 100vh;
    background: var(--dark);
    font-family: 'Lato', sans-serif;
    color: var(--cream);
    overflow-x: hidden;
  }

  /* Fond d√©coratif */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse at 20% 20%, rgba(201,168,76,0.12) 0%, transparent 50%),
      radial-gradient(ellipse at 80% 80%, rgba(139,26,26,0.12) 0%, transparent 50%),
      repeating-linear-gradient(45deg, transparent, transparent 40px, rgba(201,168,76,0.03) 40px, rgba(201,168,76,0.03) 41px);
    pointer-events: none;
    z-index: 0;
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  /* Ornement */
  .ornament {
    color: var(--gold);
    font-size: 2rem;
    opacity: 0.6;
    letter-spacing: 10px;
    text-align: center;
    margin: 8px 0;
  }

  /* --- √âCRAN D'ACCUEIL --- */
  #screen-welcome {
    text-align: center;
    width: 100%;
    animation: fadeIn 0.8s ease;
  }

  .crown {
    font-size: 4rem;
    margin-bottom: 10px;
    filter: drop-shadow(0 0 20px rgba(201,168,76,0.6));
    animation: pulse 3s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  h1 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(1.8rem, 5vw, 3rem);
    font-weight: 900;
    color: var(--gold-light);
    text-shadow: 0 2px 20px rgba(201,168,76,0.4);
    line-height: 1.2;
    margin-bottom: 6px;
  }

  .subtitle {
    font-family: 'Playfair Display', serif;
    font-size: clamp(0.9rem, 2.5vw, 1.2rem);
    color: rgba(253,246,227,0.7);
    font-style: italic;
    margin-bottom: 24px;
  }

  .rules-box {
    background: rgba(42,30,10,0.8);
    border: 1px solid rgba(201,168,76,0.3);
    border-radius: 12px;
    padding: 20px 24px;
    margin: 20px 0;
    text-align: left;
  }

  .rules-box h2 {
    font-family: 'Playfair Display', serif;
    color: var(--gold);
    font-size: 1.1rem;
    margin-bottom: 12px;
    text-align: center;
    letter-spacing: 2px;
    text-transform: uppercase;
  }

  .rules-box ul {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .rules-box li {
    padding-left: 20px;
    position: relative;
    font-size: 0.95rem;
    color: rgba(253,246,227,0.85);
    line-height: 1.5;
  }

  .rules-box li::before {
    content: '‚öú';
    position: absolute;
    left: 0;
    color: var(--gold);
    font-size: 0.7rem;
    top: 4px;
  }

  .name-section {
    margin-top: 24px;
    width: 100%;
  }

  .name-section label {
    display: block;
    font-family: 'Playfair Display', serif;
    color: var(--gold-light);
    font-size: 1.1rem;
    margin-bottom: 10px;
  }

  .name-input {
    width: 100%;
    padding: 14px 18px;
    font-family: 'Playfair Display', serif;
    font-size: 1.2rem;
    background: rgba(42,30,10,0.9);
    border: 2px solid rgba(201,168,76,0.4);
    border-radius: 8px;
    color: var(--cream);
    outline: none;
    transition: border-color 0.3s;
    text-align: center;
  }

  .name-input:focus {
    border-color: var(--gold);
    box-shadow: 0 0 15px rgba(201,168,76,0.2);
  }

  .btn-start {
    margin-top: 20px;
    width: 100%;
    padding: 16px;
    background: linear-gradient(135deg, #c9a84c, #8b6914, #c9a84c);
    background-size: 200% 200%;
    border: none;
    border-radius: 8px;
    font-family: 'Playfair Display', serif;
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--dark);
    cursor: pointer;
    letter-spacing: 2px;
    text-transform: uppercase;
    transition: all 0.3s;
    animation: shimmer 3s linear infinite;
  }

  @keyframes shimmer {
    0% { background-position: 0% 50%; }
    100% { background-position: 200% 50%; }
  }

  .btn-start:hover, .btn-start:active {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(201,168,76,0.4);
  }

  /* --- √âCRAN JEU --- */
  #screen-game {
    width: 100%;
    display: none;
    animation: fadeIn 0.5s ease;
  }

  .progress-bar {
    width: 100%;
    background: rgba(255,255,255,0.1);
    border-radius: 50px;
    height: 6px;
    margin-bottom: 20px;
    overflow: hidden;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--gold), var(--gold-light));
    border-radius: 50px;
    transition: width 0.5s ease;
  }

  .score-display {
    text-align: right;
    font-family: 'Playfair Display', serif;
    color: var(--gold);
    font-size: 0.95rem;
    margin-bottom: 16px;
  }

  .question-count {
    font-family: 'Playfair Display', serif;
    color: rgba(253,246,227,0.5);
    font-size: 0.85rem;
    text-align: center;
    margin-bottom: 12px;
    letter-spacing: 3px;
    text-transform: uppercase;
  }

  .question-box {
    background: rgba(42,30,10,0.85);
    border: 1px solid rgba(201,168,76,0.25);
    border-radius: 16px;
    padding: 28px 24px;
    margin-bottom: 24px;
    min-height: 140px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .question-text {
    font-family: 'Playfair Display', serif;
    font-size: clamp(1.1rem, 3vw, 1.5rem);
    font-weight: 700;
    color: var(--cream);
    text-align: center;
    line-height: 1.5;
  }

  .answers-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    width: 100%;
  }

  .answer-btn {
    padding: 16px 14px;
    background: rgba(42,30,10,0.7);
    border: 2px solid rgba(201,168,76,0.2);
    border-radius: 10px;
    font-family: 'Lato', sans-serif;
    font-size: clamp(0.9rem, 2.5vw, 1.05rem);
    color: var(--cream);
    cursor: pointer;
    text-align: center;
    transition: all 0.2s;
    line-height: 1.4;
    min-height: 70px;
    display: flex;
    align-items: center;
    justify-content: center;
    -webkit-tap-highlight-color: transparent;
  }

  .answer-btn:hover, .answer-btn:active {
    border-color: var(--gold);
    background: rgba(201,168,76,0.15);
    transform: translateY(-2px);
  }

  .answer-btn.correct {
    border-color: #4caf50;
    background: rgba(76,175,80,0.2);
    color: #a5d6a7;
    animation: correctPulse 0.5s ease;
  }

  .answer-btn.wrong {
    border-color: #e53935;
    background: rgba(229,57,53,0.15);
    color: #ef9a9a;
    animation: shake 0.4s ease;
  }

  .answer-btn.reveal {
    border-color: #4caf50;
    background: rgba(76,175,80,0.1);
    color: #a5d6a7;
  }

  .answer-btn:disabled {
    cursor: default;
  }

  @keyframes correctPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.04); }
    100% { transform: scale(1); }
  }

  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-8px); }
    75% { transform: translateX(8px); }
  }

  .feedback {
    text-align: center;
    margin-top: 16px;
    font-family: 'Playfair Display', serif;
    font-size: 1.1rem;
    min-height: 28px;
    transition: all 0.3s;
  }

  .feedback.good { color: #a5d6a7; }
  .feedback.bad { color: #ef9a9a; }

  /* --- √âCRAN R√âSULTAT --- */
  #screen-result {
    display: none;
    text-align: center;
    width: 100%;
    animation: fadeIn 0.8s ease;
  }

  .result-crown {
    font-size: 5rem;
    margin-bottom: 10px;
    filter: drop-shadow(0 0 25px rgba(201,168,76,0.8));
  }

  .result-name {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
    color: var(--gold-light);
    margin-bottom: 8px;
  }

  .result-score {
    font-family: 'Playfair Display', serif;
    font-size: 4rem;
    font-weight: 900;
    color: var(--gold);
    text-shadow: 0 0 30px rgba(201,168,76,0.5);
    margin: 16px 0;
  }

  .result-total {
    font-size: 1.5rem;
    color: rgba(253,246,227,0.6);
  }

  .result-msg {
    font-family: 'Playfair Display', serif;
    font-style: italic;
    font-size: 1.2rem;
    color: rgba(253,246,227,0.8);
    margin: 20px 0;
    padding: 16px;
    border-top: 1px solid rgba(201,168,76,0.2);
    border-bottom: 1px solid rgba(201,168,76,0.2);
  }

  .saving-msg {
    font-size: 0.85rem;
    color: rgba(253,246,227,0.4);
    margin-top: 10px;
  }

  .btn-retry {
    margin-top: 20px;
    padding: 14px 32px;
    background: transparent;
    border: 2px solid var(--gold);
    border-radius: 8px;
    font-family: 'Playfair Display', serif;
    font-size: 1rem;
    color: var(--gold);
    cursor: pointer;
    letter-spacing: 2px;
    text-transform: uppercase;
    transition: all 0.3s;
  }

  .btn-retry:hover {
    background: rgba(201,168,76,0.1);
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(15px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Responsive tablette */
  @media (max-width: 480px) {
    .answers-grid { grid-template-columns: 1fr; }
    .answer-btn { min-height: 56px; }
  }
</style>
</head>
<body>
<div class="container">

  <!-- √âCRAN ACCUEIL -->
  <div id="screen-welcome">
    <div class="crown">üëë</div>
    <div class="ornament">‚ú¶ ‚ú¶ ‚ú¶</div>
    <h1>Les Odyss√©es<br>√† Versailles</h1>
    <p class="subtitle">Louis XIV et les Plaisirs de l'√Æle enchant√©e</p>
    <div class="ornament">‚öú ‚öú ‚öú</div>

    <div class="rules-box">
      <h2>üìú R√®gles du jeu</h2>
      <ul>
        <li>√âcoute bien le podcast avant de jouer !</li>
        <li>10 questions sur Louis XIV et Versailles t'attendent.</li>
        <li>Pour chaque question, clique sur la bonne r√©ponse parmi 4 propositions.</li>
        <li>Une bonne r√©ponse = 1 point. Tu passes toujours √† la suivante.</li>
        <li>Ton score sera enregistr√© √† la fin. Bonne chance !</li>
      </ul>
    </div>

    <div class="name-section">
      <label for="playerName">‚úçÔ∏è Entre ton pr√©nom pour commencer :</label>
      <input type="text" id="playerName" class="name-input" placeholder="Mon pr√©nom‚Ä¶" maxlength="30" autocomplete="off">
      <button class="btn-start" onclick="startGame()">‚öú Entrer dans le ch√¢teau ‚öú</button>
    </div>
  </div>

  <!-- √âCRAN JEU -->
  <div id="screen-game">
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    <div class="score-display">Score : <span id="scoreDisplay">0</span> / <span id="totalDisplay">10</span></div>
    <div class="question-count" id="questionCount">Question 1 / 10</div>

    <div class="question-box">
      <p class="question-text" id="questionText"></p>
    </div>

    <div class="answers-grid" id="answersGrid"></div>
    <div class="feedback" id="feedback"></div>
  </div>

  <!-- √âCRAN R√âSULTAT -->
  <div id="screen-result">
    <div class="result-crown" id="resultEmoji">üèÜ</div>
    <div class="ornament">‚ú¶ ‚ú¶ ‚ú¶</div>
    <p class="result-name" id="resultName"></p>
    <div class="result-score" id="resultScore"></div>
    <div class="result-total" id="resultTotal"></div>
    <p class="result-msg" id="resultMsg"></p>
    <p class="saving-msg" id="savingMsg">üìä Score enregistr√©‚Ä¶</p>
    <button class="btn-retry" onclick="resetGame()">‚Ü© Rejouer</button>
  </div>

</div>

<script>
// ---- QUESTIONS ----
const questions = [
  {
    q: "En quelle ann√©e Louis XIV organise-t-il la f√™te des ¬´ Plaisirs de l'√Æle enchant√©e ¬ª ?",
    answers: ["1664", "1682", "1715", "1643"],
    correct: 0
  },
  {
    q: "O√π se d√©roule cette grande f√™te organis√©e par Louis XIV ?",
    answers: ["Au Louvre, √† Paris", "Au ch√¢teau de Versailles", "Au palais de Fontainebleau", "√Ä Versailles, dans les jardins"],
    correct: 3
  },
  {
    q: "Quel √¢ge avait environ Louis XIV lors de cette f√™te en 1664 ?",
    answers: ["15 ans", "25 ans", "35 ans", "45 ans"],
    correct: 1
  },
  {
    q: "Combien de jours a dur√© la f√™te des ¬´ Plaisirs de l'√Æle enchant√©e ¬ª ?",
    answers: ["1 jour", "3 jours", "7 jours", "15 jours"],
    correct: 2
  },
  {
    q: "Quel surnom c√©l√®bre portait Louis XIV ?",
    answers: ["Le Roi Vert", "Le Roi Soleil", "Le Grand Monarque", "Le Roi de Fer"],
    correct: 1
  },
  {
    q: "Le ch√¢teau de Versailles est situ√© pr√®s de quelle ville ?",
    answers: ["Lyon", "Bordeaux", "Paris", "Nantes"],
    correct: 2
  },
  {
    q: "Louis XIV fait construire Versailles pour montrer quoi √† toute la France ?",
    answers: ["Sa collection de tableaux", "Sa puissance et sa richesse", "Son arm√©e invincible", "Ses jardins potagers"],
    correct: 1
  },
  {
    q: "Qui racontait ce podcast des Odyss√©es ?",
    answers: ["Laure Grandbesan√ßon", "Marie Curie", "Anne-Sophie Pic", "Charlotte Gainsbourg"],
    correct: 0
  },
  {
    q: "La f√™te √† Versailles durait plusieurs jours avec des spectacles, de la musique et‚Ä¶ quoi d'autre ?",
    answers: ["Des matchs de football", "Des feux d'artifice et des banquets", "Des courses de chevaux uniquement", "Des examens pour les courtisans"],
    correct: 1
  },
  {
    q: "Les Odyss√©es est un podcast destin√© aux enfants de quel √¢ge ?",
    answers: ["3 √† 6 ans", "7 √† 12 ans", "12 √† 16 ans", "Tous les √¢ges"],
    correct: 1
  }
];

// ---- √âTAT DU JEU ----
let currentQ = 0;
let score = 0;
let playerName = '';
let answered = false;

// URL Google Apps Script (√† remplacer apr√®s d√©ploiement)
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw3vw4Z1WrFpj17o5qE4vihb-lEHI1wJttgOcU62O0zRIx24PR9iF-anGGjyQdbkNNX/exec';

function startGame() {
  const input = document.getElementById('playerName').value.trim();
  if (!input) {
    document.getElementById('playerName').focus();
    document.getElementById('playerName').style.borderColor = '#e53935';
    setTimeout(() => document.getElementById('playerName').style.borderColor = '', 1500);
    return;
  }
  playerName = input;
  currentQ = 0;
  score = 0;
  answered = false;

  document.getElementById('screen-welcome').style.display = 'none';
  document.getElementById('screen-game').style.display = 'block';
  document.getElementById('totalDisplay').textContent = questions.length;
  loadQuestion();
}

function loadQuestion() {
  answered = false;
  const q = questions[currentQ];
  document.getElementById('questionCount').textContent = `Question ${currentQ + 1} / ${questions.length}`;
  document.getElementById('scoreDisplay').textContent = score;
  document.getElementById('progressFill').style.width = `${(currentQ / questions.length) * 100}%`;
  document.getElementById('questionText').textContent = q.q;
  document.getElementById('feedback').textContent = '';
  document.getElementById('feedback').className = 'feedback';

  const grid = document.getElementById('answersGrid');
  grid.innerHTML = '';

  // M√©langer les r√©ponses
  const indices = [0, 1, 2, 3];
  const shuffled = indices.sort(() => Math.random() - 0.5);

  shuffled.forEach(i => {
    const btn = document.createElement('button');
    btn.className = 'answer-btn';
    btn.textContent = q.answers[i];
    btn.dataset.index = i;
    btn.onclick = () => selectAnswer(btn, i);
    grid.appendChild(btn);
  });
}

function selectAnswer(btn, index) {
  if (answered) return;
  answered = true;

  const q = questions[currentQ];
  const allBtns = document.querySelectorAll('.answer-btn');
  allBtns.forEach(b => b.disabled = true);

  if (index === q.correct) {
    btn.classList.add('correct');
    score++;
    document.getElementById('feedback').textContent = '‚ú® Bravo, bonne r√©ponse !';
    document.getElementById('feedback').className = 'feedback good';
  } else {
    btn.classList.add('wrong');
    // R√©v√©ler la bonne r√©ponse
    allBtns.forEach(b => {
      if (parseInt(b.dataset.index) === q.correct) b.classList.add('reveal');
    });
    document.getElementById('feedback').textContent = '‚ùå Rat√© ! La bonne r√©ponse est surlign√©e.';
    document.getElementById('feedback').className = 'feedback bad';
  }

  document.getElementById('scoreDisplay').textContent = score;

  setTimeout(() => {
    currentQ++;
    if (currentQ < questions.length) {
      loadQuestion();
    } else {
      showResult();
    }
  }, 1800);
}

function showResult() {
  document.getElementById('screen-game').style.display = 'none';
  document.getElementById('screen-result').style.display = 'block';

  const pct = score / questions.length;
  let emoji, msg;

  if (pct === 1) {
    emoji = 'üëë'; msg = 'Parfait ! Tu es digne d\'entrer √† Versailles !';
  } else if (pct >= 0.8) {
    emoji = 'üèÜ'; msg = 'Excellent ! Louis XIV t\'aurait invit√© √† sa f√™te !';
  } else if (pct >= 0.6) {
    emoji = '‚≠ê'; msg = 'Bien jou√© ! Tu connais bien l\'histoire de Versailles.';
  } else if (pct >= 0.4) {
    emoji = 'üìú'; msg = 'Pas mal, mais r√©√©coute le podcast pour t\'am√©liorer !';
  } else {
    emoji = 'üé≠'; msg = 'Continue d\'√©couter les Odyss√©es, tu progresseras !';
  }

  document.getElementById('resultEmoji').textContent = emoji;
  document.getElementById('resultName').textContent = playerName;
  document.getElementById('resultScore').textContent = score;
  document.getElementById('resultTotal').textContent = `/ ${questions.length}`;
  document.getElementById('resultMsg').textContent = msg;

  // Envoi au Google Sheet
  saveScore();
}

function saveScore() {
  const now = new Date().toLocaleString('fr-FR');
  const data = { name: playerName, score: score, total: questions.length, date: now, episode: 'Ep.1 - Plaisirs ile enchantee' };

  fetch(SCRIPT_URL, {
    method: 'POST',
    mode: 'no-cors',
    body: JSON.stringify(data),
    headers: { 'Content-Type': 'application/json' }
  }).then(() => {
    document.getElementById('savingMsg').textContent = '‚úÖ Score enregistr√© avec succ√®s !';
  }).catch(() => {
    document.getElementById('savingMsg').textContent = '‚ö†Ô∏è Impossible d\'enregistrer le score.';
  });
}

function resetGame() {
  document.getElementById('screen-result').style.display = 'none';
  document.getElementById('screen-welcome').style.display = 'block';
  document.getElementById('playerName').value = '';
}

// Entr√©e clavier pour d√©marrer
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('playerName').addEventListener('keydown', e => {
    if (e.key === 'Enter') startGame();
  });
});
</script>
</body>
</html>
